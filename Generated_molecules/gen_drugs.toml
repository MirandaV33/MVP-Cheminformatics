run_type = "staged_learning"
device = "cpu"
tb_logdir = "tb_logs"
json_out_config = "generative_mol.json"

[parameters]
summary_csv_prefix = "generative_mol"
use_checkpoint = false
purge_memories = false

prior_file = "../priors/mol2mol_medium_similarity.prior"
agent_file = "../priors/mol2mol_medium_similarity.prior"
smiles_file = "found_drugs.smi"  
sample_strategy = "multinomial"
distance_threshold = 100

batch_size = 64
unique_sequences = true
randomize_smiles = true
tb_isim = false

[learning_strategy]
type = "dap"
sigma = 80
rate = 0.0001

[diversity_filter]
type = "IdenticalMurckoScaffold"
bucket_size = 25
minscore = 0.5
minsimilarity = 0.5
penalty_multiplier = 0.5

[[stage]]
chkpt_file = "mol2mol_stage1.chkpt"

termination = "simple"
max_score = 0.8
min_steps = 25
max_steps = 350

[stage.scoring]
type = "geometric_mean"

[[stage.scoring.component]]
[stage.scoring.component.TanimotoDistance]

[[stage.scoring.component.TanimotoDistance.endpoint]]
name = "Tanimoto vs seeds"
weight = 0.7
params.smiles = [
  "CCNC(=O)C[C@@H]1N=C(c2ccc(Cl)cc2)c2cc(OC)ccc2-n2c(C)nnc21",
  "CCN(CC)CC1CCN(c2ncc3ncnc(Nc4ccc(F)c(Cl)c4)c3n2)CC1",
  "CCC(=O)N1CCN(c2ccc(-n3c(=O)ccc4cnc5ccc(-c6cnc7ccccc7c6)cc5c43)cc2C(F)(F)F)CC1",
  "C=CCNC1=C2C[C@@H](C)C[C@H](OC)[C@H](O)[C@@H](C)/C=C(\\C)[C@H](OC(N)=O)[C@@H](OC)/C=C\\C=C(/C)C(=O)NC(=CC1=O)C2=O",
  "O=C(NOC[C@H](O)CO)c1ccc(F)c(F)c1Nc1ccc(I)cc1F",
  "CCN(CC)CCNC(=O)c1c(C)[nH]c(/C=C2\\C(=O)Nc3ccc(F)cc32)c1C",
  "CC1=C(C=CC(=C1)O)C2=CC3=C(C=C2)C(=O)NC4=C3C=CC(=C4)C5=C(C=C(C=C5)O)O"
]
params.radius = 2
params.use_counts = true
params.use_features = false

[[stage.scoring.component]]
[stage.scoring.component.QED]
[[stage.scoring.component.QED.endpoint]]
name = "QED"
weight = 0.6

[[stage.scoring.component]]
[stage.scoring.component.SAScore]
[[stage.scoring.component.SAScore.endpoint]]
name = "SA score"
weight = 0.3